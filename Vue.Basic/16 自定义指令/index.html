<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="../js/vue.js"></script>
    <!-- 引入 day.js cdn-->
    <script src="https://cdn.bootcdn.net/ajax/libs/dayjs/1.11.7/dayjs.min.js"></script>
</head>

<body>
    <!-- 需求 1：定义一个 v-big 指令，和 v-text 功能类似，但会把绑定的数值放大 10 倍。 -->
    <!-- 需求 2：定义一个 v-fbind 指令，和 v-bind 功能类似，但可以让其所绑定的 input 元素默认获取焦点。 -->
    <div id="app">
        <h2>当前的n值是：<span v-text="n"></span></h2>
        <h2>放大10倍后的n值是：<span v-big="n"></span></h2>
        <button @click="n++">点我n+1</button>
        <hr>
        <input type="text" v-fbind="n">
        <input type="text" v-fbind-max="n">
    </div>

    <script>
        // 全局自定义指令
        Vue.directive('big', function(el, binding) {
            el.innerHTML = binding.value * 10
        })


        let vm = new Vue({
            el: '#app',
            data: {
                n: 1
            },
            // 所有自定义指令中的 this 都指向 windows
            directives: {
                // 这种方式是 key value，函数名在有 - 字符的时候，要写全。
                'fbind-max' (el, binding) {

                },
                // big 自定义指令何时会被调用？1. 指令与元素成功绑定时（一上来） 2. 指令所在的模板被重新渲染时
                // 这种简写方式，相当于写了 bind 和 update 两个钩子函数
                big(el, binding) {
                    // el: 指令所绑定的元素，可以用来直接操作 DOM
                    // binding: 一个对象，包含以下属性：
                    // name: 指令名，不包括 v- 前缀。
                    // value: 指令的绑定值，例如：v-my-directive="1 + 1" 中，绑定值为 2。
                    // oldValue: 指令绑定的前一个值，仅在 update 和 componentUpdated 钩子中可用。
                    // expression: 绑定值的表达式或变量名。例如 v-my-directive="1 + 1" 中，表达式为 "1 + 1"。
                    // arg: 传给指令的参数。例如 v-my-directive:foo 中，参数为 "foo"。
                    // modifiers: 一个包含修饰符的对象。例如：v-my-directive.foo.bar 中，修饰符对象为 { foo: true, bar: true }。
                    // vnode: Vue 编译生成的虚拟节点。移步 VNode API 来了解更多详情。
                    // oldVnode: 上一个虚拟节点，仅在 update 和 componentUpdated 钩子中可用。
                    el.innerText = binding.value * 10
                },
                fbind: {
                    bind(el, binding) {
                        el.value = binding.values
                    },
                    // 如果想获取焦点、 拿到父元素这些特殊需求， 则需要写成这种的完整写法
                    inserted(el, binding) {
                        el.focus()
                    },
                    update(el, binding) {
                        el.value = binding.values
                    },
                }
            }
        })
    </script>
</body>

</html>